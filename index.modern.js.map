{"version":3,"file":"index.modern.js","sources":["index.js"],"sourcesContent":["function _interopDefault$1(ex) {\n  return ex && typeof ex === 'object' && 'default' in ex ? ex['default'] : ex;\n}\n\nvar helpers = require('babel-plugin-transform-async-to-promises/helpers');\n\nvar React = require('react');\n\nvar React__default = _interopDefault$1(React);\n\nvar reactNativeDeviceInfo = require('react-native-device-info');\n\nvar apiCall = function apiCall(_ref) {\n  var endpoint = _ref.endpoint,\n      _ref$method = _ref.method,\n      method = _ref$method === void 0 ? 'GET' : _ref$method,\n      _ref$body = _ref.body,\n      body = _ref$body === void 0 ? {} : _ref$body;\n\n  try {\n    return Promise.resolve(helpers._catch(function () {\n      return Promise.resolve(fetch(endpoint, {\n        method: method,\n        mode: 'cors',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        body: JSON.stringify(body)\n      })).then(Promise.resolve);\n    }, function (err) {\n      console.error(err);\n      throw err;\n    }));\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nvar ENDPOINT = 'http://localhost:8000';\n\nfunction ABExperiment(_ref) {\n  var record = function record(metric) {\n    try {\n      var _temp2 = helpers._catch(function () {\n        return Promise.resolve(apiCall({\n          endpoint: ENDPOINT + \"/api/record\",\n          method: 'POST',\n          body: {\n            deviceId: token,\n            metric: metric,\n            variant: variant,\n            experimentToken: token\n          }\n        })).then(function () {});\n      }, function (err) {\n        consol.error(err);\n      });\n\n      return Promise.resolve(_temp2 && _temp2.then ? _temp2.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n\n  var fetchVariant = function fetchVariant() {\n    try {\n      var _temp4 = helpers._catch(function () {\n        return Promise.resolve(reactNativeDeviceInfo.getUniqueId()).then(function (deviceId) {\n          return Promise.resolve(apiCall({\n            endpoint: ENDPOINT + \"/api/initialize/\" + deviceId + \"/\" + token,\n            method: 'GET'\n          })).then(function (variantPayload) {\n            setVariant(variantPayload.variant);\n          });\n        });\n      }, function (err) {\n        console.error(err);\n        setVariant('a');\n      });\n\n      return Promise.resolve(_temp4 && _temp4.then ? _temp4.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n\n  var componentA = _ref.componentA,\n      componentB = _ref.componentB,\n      token = _ref.token,\n      _ref$track = _ref.track,\n      track = _ref$track === void 0 ? ['impression', 'interaction'] : _ref$track,\n      _ref$onClick = _ref.onClick,\n      _onClick = _ref$onClick === void 0 ? null : _ref$onClick;\n\n  var _useState = useState(null),\n      variant = _useState[0],\n      setVariant = _useState[1];\n\n  useEffect(function () {\n    fetchVariant();\n  }, []);\n  useEffect(function () {\n    if (variant && track.includes('impression')) {\n      record('impression');\n    }\n  }, [variant]);\n\n  if (variant) {\n    return null;\n  }\n\n  var ComponentReturn = variant === 'a' ? componentA : componentB;\n  return /*#__PURE__*/React__default.createElement(ComponentReturn, {\n    onClick: function onClick() {\n      record('interaction');\n\n      _onClick();\n    }\n  });\n}\n\nmodule.exports = ABExperiment;\n//# sourceMappingURL=index.js.map\n"],"names":["apiCall","endpoint","method","body","fetch","mode","headers","JSON","console"],"mappings":";;;;;;;;;;;;IAAsBA,OAAtB,GAAA,SAAA,OAAA,CAAA,IAAA,EAAA;AAAA,MACEC,QADF,GAAA,IAAA,CAAA,QAAA;AAAA,MAAA,WAAA,GAAA,IAAA,CAAA,MAAA;AAAA,MAEEC,MAFF,GAAA,WAAA,KAAA,KAAA,CAAA,GAAA,KAAA,GAAA,WAAA;AAAA,MAAA,SAAA,GAAA,IAAA,CAAA,IAAA;AAAA,MAGEC,IAHF,GAAA,SAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,SAAA;;AAAA,MAIG;AAAA,WAAA,OAAA,CAAA,OAAA,CAAA,OAAA,CAAA,MAAA,CAAA,YACG;AAAA,aAAA,OAAA,CAAA,OAAA,CACqBC,KAAK,CAAA,QAAA,EAAW;AACrCF,QAAAA,MAAM,EAD+B,MAAA;AAErCG,QAAAA,IAAI,EAFiC,MAAA;AAGrCC,QAAAA,OAAO,EAAE;AACP,0BAAgB;AADT,SAH4B;AAMrCH,QAAAA,IAAI,EAAEI,IAAI,CAAJA,SAAAA,CAAAA,IAAAA;AAN+B,OAAX,CAD1B,EAAA,IAAA,CAAA,OAAA,CAAA,OAAA,CAAA;AADH,KAAA,EAAA,UAAA,GAAA,EAaY;AACXC,MAAAA,OAAO,CAAPA,KAAAA,CAAAA,GAAAA;AACA,YAAA,GAAA;AAfD,KAAA,CAAA,CAAA;AAJH,GAAA,CAAA,OAAA,CAAA,EAAA;AAAA,WAAA,OAAA,CAAA,MAAA,CAAA,CAAA,CAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}